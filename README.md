# YAMEILO YAML Visualizer (Yameilo)

一个功能强大的现代化 YAML 配置文件可视化编辑器，支持双面板编辑、表单式操作和智能排序。

## ✨ 功能特性

### 📄 文件操作
- **文件上传**: 支持拖拽或点击上传 YAML 文件
- **文件保存**: 将编辑后的配置保存为 YAML 文件
- **文件名编辑**: 点击文件名即可编辑，自动添加 `.yaml` 扩展名
- **文件清空**: 一键清空当前编辑内容
- **注释保留**: 使用 `yaml` 库的高级 API 保留 YAML 文件中的注释

### 📝 双面板编辑
- **Monaco 编辑器**: 基于 VS Code 的 Monaco Editor，提供专业的代码编辑体验
  - 语法高亮
  - 自动补全
  - 实时语法验证
  - 代码格式化
- **表单编辑器**: 直观的表单式界面，适合非技术用户
  - 可视化嵌套结构
  - 类型标识和转换
  - 拖拽排序

### 🎯 表单编辑功能

#### 基础操作
- **展开/折叠**: 递归展开/折叠所有嵌套结构
- **编辑值**: 直接修改配置值
- **修改键名**: 支持重命名键
- **添加项**: 支持添加字符串、数字、布尔值、对象、数组
- **删除项**: 一键删除不需要的配置项

#### 高级功能
- **类型转换**: 支持在字符串、数字、布尔值、对象、数组之间转换
- **拖拽排序**: 
  - 数组项拖拽排序
  - 对象键拖拽排序
  - 拖拽时视觉反馈（半透明、高亮边框）
- **递归展开/折叠**: 全部展开/折叠功能支持递归操作，一次性展开/折叠所有层级

### 🔧 工具栏功能
- **搜索配置**: 实时搜索配置项，支持快捷键 `Ctrl+F` / `Cmd+F`
- **智能排序**: 一键按 key 字母顺序递归排序所有配置项
- **格式化**: 格式化 YAML 代码，统一缩进和格式
- **全部展开/折叠**: 递归展开/折叠所有嵌套结构
- **主题切换**: 一键切换亮色/暗色主题
- **实时同步**: 编辑器和表单双向实时同步
- **GitHub 链接**: 快速访问项目仓库并给个 Star ⭐

### 🔍 搜索功能
- **实时搜索**: 在配置项中实时搜索，高亮匹配项
- **快捷键支持**: 使用 `Ctrl+F` (Windows/Linux) 或 `Cmd+F` (Mac) 快速聚焦搜索框
- **匹配计数**: 显示搜索结果的匹配数量
- **快速清除**: 一键清除搜索条件

### 🎨 主题与用户体验
- **双主题支持**: 支持亮色和暗色主题切换
- **主题持久化**: 主题偏好自动保存到本地存储
- **系统偏好检测**: 自动检测并应用系统主题偏好
- **现代化 UI**: 美观的用户界面设计
- **响应式布局**: 适配不同屏幕尺寸
- **实时验证**: 编辑时实时显示语法错误
- **智能提示**: 鼠标悬停显示操作提示
- **视觉反馈**: 拖拽、悬停等操作都有清晰的视觉反馈

## 🚀 快速开始

### 环境要求
- Node.js >= 16
- npm >= 7

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

应用将在 `http://localhost:5173` 启动

### 构建生产版本

```bash
npm run build
```

构建产物将输出到 `dist` 目录

### 预览生产版本

```bash
npm run preview
```

## 🚀 部署到 GitHub Pages

本项目已配置自动部署到 GitHub Pages。每次推送到 `main` 分支时，GitHub Actions 会自动构建并部署项目。

### 在线访问

🌐 **在线地址**: [https://deantook.github.io/yameilo/](https://deantook.github.io/yameilo/)

### 部署步骤

1. **推送代码**
   - 推送代码到 `main` 分支
   - GitHub Actions 会自动触发构建和部署
   - **注意**：工作流已配置 `enablement: true`，会自动启用 GitHub Pages，无需手动配置

2. **访问网站**
   - 部署完成后，访问 `https://deantook.github.io/yameilo/`
   - 如果仓库名称或用户名不同，请相应修改 URL

### 手动启用 GitHub Pages（可选）

如果自动启用失败，可以手动配置：
- 进入仓库的 Settings → Pages
- Source 选择 "GitHub Actions"

### 手动触发部署

如果需要手动触发部署，可以：
- 进入仓库的 Actions 页面
- 选择 "Deploy to GitHub Pages" 工作流
- 点击 "Run workflow"

## 📖 使用方法

### 1. 加载文件
- 点击上传区域或拖拽 YAML 文件到页面
- 文件加载后会自动解析并在编辑器和表单中显示

### 2. 编辑配置

#### 在编辑器中编辑
- 直接在左侧 Monaco 编辑器中编辑 YAML 代码
- 支持语法高亮、自动补全、格式化
- 修改会自动同步到右侧表单

#### 在表单中编辑
- **展开/折叠**: 点击展开按钮查看嵌套结构
- **修改值**: 直接在输入框中修改
- **修改键名**: 点击键名输入框进行修改
- **添加项**: 点击绿色的 ➕ 按钮，选择要添加的类型
- **删除项**: 点击红色的 🗑️ 按钮
- **类型转换**: 点击类型标签（如"字符串"），选择新类型
- **拖拽排序**: 点击并拖拽左侧的拖拽手柄进行排序

### 3. 工具栏操作
- **搜索**: 点击搜索框或按 `Ctrl+F` / `Cmd+F` 搜索配置项
- **排序**: 点击排序按钮，所有 key 按字母顺序递归排序
- **格式化**: 点击格式化按钮，统一代码格式
- **全部展开/折叠**: 一键展开/折叠所有层级
- **主题切换**: 点击主题按钮切换亮色/暗色主题
- **保存**: 点击保存按钮下载编辑后的 YAML 文件
- **清空**: 清空当前编辑内容
- **文件名编辑**: 点击文件名进行编辑，支持自定义文件名

## 🛠️ 技术栈

- **React 18**: 现代化的 React 框架
- **TypeScript**: 类型安全的 JavaScript
- **Vite**: 快速的构建工具
- **Monaco Editor**: VS Code 的编辑器核心
- **yaml**: YAML 解析和生成库（支持注释保留）
- **js-yaml**: YAML 解析和生成库（备用）

## 📁 项目结构

```
yameilo/
├── src/
│   ├── components/
│   │   ├── YAMLVisualizer.tsx    # 主可视化组件
│   │   ├── YAMLEditor.tsx         # Monaco 编辑器组件
│   │   ├── YAMLForm.tsx           # 表单编辑器组件
│   │   ├── FileUploader.tsx       # 文件上传组件
│   │   └── Icons.tsx              # 图标组件
│   ├── App.tsx                    # 应用入口
│   └── main.tsx                   # 应用启动文件
├── public/                        # 静态资源
├── package.json                   # 项目配置
└── README.md                      # 项目文档
```

## 🎯 核心功能详解

### 类型转换
支持在以下类型之间转换：
- **字符串** (string)
- **数字** (number)
- **布尔值** (boolean)
- **对象** (object)
- **数组** (array)

转换时会智能处理数据，例如：
- 字符串转数字：尝试解析数字
- 字符串转布尔值：识别 "true"/"false" 等
- 对象转数组：将对象值转为数组

### 拖拽排序
- **数组项排序**: 拖拽数组项的拖拽手柄可以重新排序
- **对象键排序**: 拖拽对象项的拖拽手柄可以重新排序键的顺序
- **视觉反馈**: 
  - 拖拽时被拖拽项半透明显示
  - 悬停位置显示蓝色边框提示

### 递归展开/折叠
- **全部展开**: 一次性展开所有层级的嵌套结构
- **全部折叠**: 一次性折叠所有层级的嵌套结构
- **智能路径**: 使用完整路径管理展开状态，确保所有层级正确响应

### 搜索功能
- **实时搜索**: 输入关键词后实时高亮匹配的配置项
- **快捷键**: `Ctrl+F` (Windows/Linux) 或 `Cmd+F` (Mac) 快速聚焦搜索框
- **匹配计数**: 显示当前搜索结果的匹配数量
- **清除搜索**: 点击清除按钮或按 `Esc` 键清除搜索条件

### 注释保留
- **智能保留**: 使用 `yaml` 库的 `parseDocument` API 解析文档，保留原始注释
- **注释更新**: 编辑配置时尽可能保留原有注释
- **注释位置**: 支持行前注释、行后注释和键注释

## 🔍 使用示例

### 示例 YAML 文件

```yaml
name: "示例配置"
version: 1.0
enabled: true
database:
  host: "localhost"
  port: 5432
  credentials:
    username: "admin"
    password: "secret"
features:
  - "feature1"
  - "feature2"
  - "feature3"
```

### 操作示例

1. **添加新配置项**: 点击 ➕ 按钮 → 选择类型 → 输入键名和值
2. **修改类型**: 点击类型标签 → 选择新类型 → 自动转换
3. **排序配置**: 点击排序按钮 → 所有 key 按字母顺序排列
4. **拖拽排序**: 拖拽数组项或对象键 → 重新排序

## 📝 注意事项

- YAML 文件必须是有效的格式，否则会显示解析错误
- 编辑器和表单会实时同步，但编辑时会有短暂延迟以避免冲突
- 保存文件时会使用当前文件名，如果没有文件名则默认为 `未命名文件.yaml`
- 文件名会自动添加 `.yaml` 扩展名（如果没有的话）
- 类型转换可能会丢失数据，请谨慎操作
- 注释保留功能在复杂编辑场景下可能无法完全保留所有注释
- 主题偏好会自动保存到浏览器本地存储

## ⌨️ 快捷键

- `Ctrl+F` / `Cmd+F`: 聚焦搜索框
- `Esc`: 在搜索框中时清除搜索并退出搜索框；在文件名编辑时取消编辑
- `Enter`: 确认文件名编辑

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

如果觉得这个项目有用，欢迎给个 ⭐ Star！

## 📄 许可证

MIT License
